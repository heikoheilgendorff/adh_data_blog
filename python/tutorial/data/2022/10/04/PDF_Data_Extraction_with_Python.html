<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>PDF Data Extraction with Python (almost complete) | ADH Data Blog Staging</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="PDF Data Extraction with Python (almost complete)" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="How to extract data from a PDF using python." />
<meta property="og:description" content="How to extract data from a PDF using python." />
<link rel="canonical" href="https://heikoheilgendorff.github.io/adh_data_blog/python/tutorial/data/2022/10/04/PDF_Data_Extraction_with_Python.html" />
<meta property="og:url" content="https://heikoheilgendorff.github.io/adh_data_blog/python/tutorial/data/2022/10/04/PDF_Data_Extraction_with_Python.html" />
<meta property="og:site_name" content="ADH Data Blog Staging" />
<meta property="og:image" content="https://heikoheilgendorff.github.io/adh_data_blog/images/chart-preview.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-10-04T00:00:00-05:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="https://heikoheilgendorff.github.io/adh_data_blog/images/chart-preview.png" />
<meta property="twitter:title" content="PDF Data Extraction with Python (almost complete)" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-04T00:00:00-05:00","datePublished":"2022-10-04T00:00:00-05:00","description":"How to extract data from a PDF using python.","headline":"PDF Data Extraction with Python (almost complete)","image":"https://heikoheilgendorff.github.io/adh_data_blog/images/chart-preview.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://heikoheilgendorff.github.io/adh_data_blog/python/tutorial/data/2022/10/04/PDF_Data_Extraction_with_Python.html"},"url":"https://heikoheilgendorff.github.io/adh_data_blog/python/tutorial/data/2022/10/04/PDF_Data_Extraction_with_Python.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/adh_data_blog/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://heikoheilgendorff.github.io/adh_data_blog/feed.xml" title="ADH Data Blog Staging" /><link rel="shortcut icon" type="image/x-icon" href="/adh_data_blog/images/favicon_adh.ico">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/adh_data_blog/">ADH Data Blog Staging</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/adh_data_blog/about/">About This Blog</a><a class="page-link" href="/adh_data_blog/search/">Search</a><a class="page-link" href="/adh_data_blog/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">PDF Data Extraction with Python (almost complete)</h1><p class="page-description">How to extract data from a PDF using python.</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-10-04T00:00:00-05:00" itemprop="datePublished">
        Oct 4, 2022
      </time>
       â€¢ <span class="read-time" title="Estimated read time">
    
    
      4 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/adh_data_blog/categories/#Python">Python</a>
        &nbsp;
      
        <a class="category-tags-link" href="/adh_data_blog/categories/#Tutorial">Tutorial</a>
        &nbsp;
      
        <a class="category-tags-link" href="/adh_data_blog/categories/#Data">Data</a>
        
      
      </p>
    

    
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul id="toc" class="section-nav">
<li class="toc-entry toc-h3"><a href="#Extracting-data-from-PDFs-using-Tabula">Extracting data from PDFs using Tabula </a></li>
<li class="toc-entry toc-h3"><a href="#Getting-Started">Getting Started </a></li>
<li class="toc-entry toc-h3"><a href="#Conclusion">Conclusion </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-20-05-PDF_Data_Extraction_with_Python.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{: style="text-align: justify" }</p>
<h3 id="Extracting-data-from-PDFs-using-Tabula">
<a class="anchor" href="#Extracting-data-from-PDFs-using-Tabula" aria-hidden="true"><span class="octicon octicon-link"></span></a>Extracting data from PDFs using Tabula<a class="anchor-link" href="#Extracting-data-from-PDFs-using-Tabula"> </a>
</h3>
<p>Data extraction from a PDF document can be an incredibly arduous task. It may not be too bad when it is required as a once-off task, but when the process needs to be repeated many times over, it can be truly crushing. Working with data in a PDF data is difficult because the data is formatted differently to how it is in a spreadsheet. This means that before we can work with and manipulate the data, we must extract it from the PDF, correct any misalignments and format interpretation errors, and then store it in a more data-friendly format like a <em>csv</em> or <em>xlsx</em> spreadsheet. One advantage when working with formal reports that have been published in PDF format is that they are typically consistently structured, with only the content changing. Thus we are often able to construct an automated process for extracting data from PDF tables, which can really help when extracting data from many files. In this tutorial, we will demonstrate how to use a python module called <a href="https://pypi.org/project/tabula-py/">Tabula</a>. Tabula allows you to pull data from a PDF and load it into a <a href="https://pypi.org/project/pandas/">Pandas</a> dataframe. It is important to note that this is only the first part of the PDF data extraction process. Once the data is in a dataframe, it then needs to be cleaned and arranged in a manner that is consistent across all datasets, before being stored. In this tutorial, we will only focus on the initial extraction process, using Tabula.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Getting-Started">
<a class="anchor" href="#Getting-Started" aria-hidden="true"><span class="octicon octicon-link"></span></a>Getting Started<a class="anchor-link" href="#Getting-Started"> </a>
</h3>
<p>In order to follow along with this tutorial, a basic understanding of the Python programming language and Python Environments is considered to be read. You will need to have Python installed, along with the Tabula module which can be downloaded using pip or <a href="https://anaconda.org/conda-forge/tabula-py">Anaconda</a>. 
For this tutorial, we have used this <a href="https://ckan.africadatahub.org/dataset/south-africa-inflation-data/resource/1d22865e-8ace-46e1-8222-ec5352334889">PDF</a> file.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tabula</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">glob</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Say we wish to extract "Table 1 - Consumer price indices for the total country", as seen below: 
<img src="/adh_data_blog/images/copied_from_nb/./images/ADH/pdf_extraction/raw_pdf.png" alt=""></p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">tabula</span><span class="o">.</span><span class="n">read_pdf</span><span class="p">(</span><span class="s1">'./data/pdf_extraction/p0141june2022_tables.pdf'</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="s2">"all"</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This will cause Tabula to parse the entire PDF document and extract all of the tables that it identifies, returning them in a list that we have called <code>tables</code>. We can reduce runtime by specifying which pages of the document to look for. In this case, Table 1 can be found on pages 3 and 4.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">tabula</span><span class="o">.</span><span class="n">read_pdf</span><span class="p">(</span><span class="s1">'./data/pdf_extraction/p0141june2022_tables.pdf'</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also specify whether Tabula should identify rows and columns with white space or lines, by specifying <code>stream</code> or <code>lattice</code> = <code>True</code>. In my experience thus far, <code>stream</code> typically provides better results.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">tabula</span><span class="o">.</span><span class="n">read_pdf</span><span class="p">(</span><span class="s1">'./data/pdf_extraction/p0141june2022_tables.pdf'</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once we have our list of tables, we can access the appropriate table from the list. Note, that the table we're interested in, Table 1, is split across two pages. Tabula will treat this as two separate tables, so in order to access Table 1, we will need to pull the first two tables from the list.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df_1</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">df_2</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have now extracted the data for Table 1 from the PDF and have it in a Pandas dataframe. From here the data can be cleaned and processed as required.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In some cases, Tabula is not automatically able to identify the table that you wish to extract. In this case, it is necessary to specify the area of the page that you are interested in. The easiest way to locate the appropriate page coordinates is to open Tabula in your browser, upload the pdf document and then manaually select the area of the table of interest via click and drag with your mouse. You have to download and install the Tabula tool from <a href="https://tabula.technology/">here</a> and <strong>note</strong>, this is separate from the Tabula module that you have installed with Python. Once you have selected your table area, you can export it as a script. Open the script in any text editor and you will see something like this:</p>
<p><code>java -jar tabula-java.jar  -a 143.249,62.261,670.851,546.702 -p 3 "$1"</code></p>
<p>Copy the numbers: <code>143.249,62.261,670.851,546.702</code> and include them in your python command as follows:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tables</span> <span class="o">=</span> <span class="n">tabula</span><span class="o">.</span><span class="n">read_pdf</span><span class="p">(</span><span class="s1">'./data/pdf_extraction/p0141june2022_tables.pdf'</span><span class="p">,</span> <span class="n">pages</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">area</span><span class="o">=</span><span class="p">(</span><span class="mf">143.249</span><span class="p">,</span><span class="mf">62.261</span><span class="p">,</span><span class="mf">670.851</span><span class="p">,</span><span class="mf">546.702</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can specify the same area over multiple pages if necessary. When extracting data from multiple reports that follow the same structure, it might be a good idea to include a bit of white space around the table when making your area selection, as different reports may have the tables in slightly different parts of the page.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Conclusion">
<a class="anchor" href="#Conclusion" aria-hidden="true"><span class="octicon octicon-link"></span></a>Conclusion<a class="anchor-link" href="#Conclusion"> </a>
</h3>
<p>In this tutorial, we have shown you how to extract data from a PDF document using a Python module called Tabula. We have used this method very successfully in extracting data from many African country Consumer Price Index reports in order to produce our Inflation database, which is used to service the ADH African Inflation observer.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/adh_data_blog/python/tutorial/data/2022/10/04/PDF_Data_Extraction_with_Python.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/adh_data_blog/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/adh_data_blog/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/adh_data_blog/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A staging site for ADH data blog posts under development</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
